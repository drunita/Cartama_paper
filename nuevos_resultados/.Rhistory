p1 <- p1 + scale_fill_manual(values=c("gray90", "gray80"))
p1 <- p1 + geom_errorbar(aes(ymin=Incidence-Incidence_se, ymax=Incidence+Incidence_se), width=.2,position=position_dodge(.9))
p1 <- p1 + facet_wrap(~ Farm) + theme_classic()
p1 <- p1 +  xlab("Harvest") + ylab("Necrotic spots") + labs(fill='Days postharvest')
p1 <- p1 + theme(axis.title =element_text(size=14,family = 'serif'))
p1 <- p1 +  theme(axis.text.x = element_text(face="bold",size=12, angle=0,family = 'serif'),
axis.text.y = element_text(face="bold",size=12, angle=0,family = 'serif'))
p1 <- p1 + theme(strip.text.x = element_text(size = 14,family = 'serif'))
p1 <- p1 + scale_color_manual(name = "Harvest", values =  c("gray88","gray70","gray47","gray0"))
p1 <- p1 + theme(legend.text = element_text(size=12, angle=0,family = 'serif'),
legend.title = element_text(face="bold",size=12, angle=0,family = 'serif'))
data_hline <- data.frame(Farm = c(rep("Escondida",4),rep( "Sinai",4)),
x = c(0.7,1.7,2.7,3.7,0.7,1.7,2.7,3.7), y = c(90, 168,70,27,240,225,257,195),xend = c(1.3,2.3,3.3,4.3,1.3,2.3,3.3,4.3), yend = c(90, 170,70,210,240,230,260,200), label = rep("*",8))
p1 <- p1 + geom_segment(data = data_hline,aes(x = x,y = y,xend = xend, yend = yend),inherit.aes = FALSE)
p1 <- p1 + geom_text(data = data_hline,aes(label = label,x = x+0.3,y = y+5),inherit.aes = FALSE)
p1
p1 <-  ggplot(mat1, aes(x = factor(Harvest, levels = c("2019_m" , "2020_t" , "2020_m" , "2021_t")), y = Incidence, fill = factor(Time))) + geom_bar(stat="identity", positio=position_dodge())
p1 <- p1 + scale_fill_manual(values=c("gray90", "gray80"))
p1 <- p1 + geom_errorbar(aes(ymin=Incidence-Incidence_se, ymax=Incidence+Incidence_se), width=.2,position=position_dodge(.9))
p1 <- p1 + facet_wrap(~ Farm) + theme_classic()
p1 <- p1 +  xlab("Harvest") + ylab("Necrotic spots") + labs(fill='Days postharvest')
p1 <- p1 + theme(axis.title =element_text(size=14,family = 'serif'))
p1 <- p1 +  theme(axis.text.x = element_text(face="bold",size=12, angle=0,family = 'serif'),
axis.text.y = element_text(face="bold",size=12, angle=0,family = 'serif'))
p1 <- p1 + theme(strip.text.x = element_text(size = 14,family = 'serif'))
p1 <- p1 + scale_color_manual(name = "Harvest", values =  c("gray88","gray70","gray47","gray0"))
p1 <- p1 + theme(legend.text = element_text(size=12, angle=0,family = 'serif'),
legend.title = element_text(face="bold",size=12, angle=0,family = 'serif'))
data_hline <- data.frame(Farm = c(rep("Escondida",4),rep( "Sinai",4)),
x = c(0.7,1.7,2.7,3.7,0.7,1.7,2.7,3.7), y = c(90, 168,70,207,240,225,257,195),xend = c(1.3,2.3,3.3,4.3,1.3,2.3,3.3,4.3), yend = c(90, 168,70,207,240,225,257,195), label = rep("*",8))
p1 <- p1 + geom_segment(data = data_hline,aes(x = x,y = y,xend = xend, yend = yend),inherit.aes = FALSE)
p1 <- p1 + geom_text(data = data_hline,aes(label = label,x = x+0.3,y = y+5),inherit.aes = FALSE)
p1
p1 <-  ggplot(mat1, aes(x = factor(Harvest, levels = c("2019_m" , "2020_t" , "2020_m" , "2021_t")), y = Incidence, fill = factor(Time))) + geom_bar(stat="identity", positio=position_dodge())
p1 <- p1 + scale_fill_manual(values=c("gray90", "gray80"))
p1 <- p1 + geom_errorbar(aes(ymin=Incidence-Incidence_se, ymax=Incidence+Incidence_se), width=.2,position=position_dodge(.9))
p1 <- p1 + facet_wrap(~ Farm) + theme_classic()
p1 <- p1 +  xlab("Harvest") + ylab("Necrotic spots") + labs(fill='Days postharvest')
p1 <- p1 + theme(axis.title =element_text(size=14,family = 'serif'))
p1 <- p1 +  theme(axis.text.x = element_text(face="bold",size=12, angle=0,family = 'serif'),
axis.text.y = element_text(face="bold",size=12, angle=0,family = 'serif'))
p1 <- p1 + theme(strip.text.x = element_text(size = 14,family = 'serif'))
p1 <- p1 + scale_color_manual(name = "Harvest", values =  c("gray88","gray70","gray47","gray0"))
p1 <- p1 + theme(legend.text = element_text(size=12, angle=0,family = 'serif'),
legend.title = element_text(face="bold",size=12, angle=0,family = 'serif'))
data_hline <- data.frame(Farm = c(rep("Escondida",4),rep( "Sinai",4)),
x = c(0.7,1.7,2.7,3.7,0.7,1.7,2.7,3.7), y = c(90, 167,70,205,239,221,257,190),xend = c(1.3,2.3,3.3,4.3,1.3,2.3,3.3,4.3), yend = c(90, 168,70,207,240,225,257,195), label = rep("*",8))
p1 <- p1 + geom_segment(data = data_hline,aes(x = x,y = y,xend = xend, yend = yend),inherit.aes = FALSE)
p1 <- p1 + geom_text(data = data_hline,aes(label = label,x = x+0.3,y = y+5),inherit.aes = FALSE)
p1
p1 <-  ggplot(mat1, aes(x = factor(Harvest, levels = c("2019_m" , "2020_t" , "2020_m" , "2021_t")), y = Incidence, fill = factor(Time))) + geom_bar(stat="identity", positio=position_dodge())
p1 <- p1 + scale_fill_manual(values=c("gray90", "gray80"))
p1 <- p1 + geom_errorbar(aes(ymin=Incidence-Incidence_se, ymax=Incidence+Incidence_se), width=.2,position=position_dodge(.9))
p1 <- p1 + facet_wrap(~ Farm) + theme_classic()
p1 <- p1 +  xlab("Harvest") + ylab("Necrotic spots") + labs(fill='Days postharvest')
p1 <- p1 + theme(axis.title =element_text(size=14,family = 'serif'))
p1 <- p1 +  theme(axis.text.x = element_text(face="bold",size=12, angle=0,family = 'serif'),
axis.text.y = element_text(face="bold",size=12, angle=0,family = 'serif'))
p1 <- p1 + theme(strip.text.x = element_text(size = 14,family = 'serif'))
p1 <- p1 + scale_color_manual(name = "Harvest", values =  c("gray88","gray70","gray47","gray0"))
p1 <- p1 + theme(legend.text = element_text(size=12, angle=0,family = 'serif'),
legend.title = element_text(face="bold",size=12, angle=0,family = 'serif'))
data_hline <- data.frame(Farm = c(rep("Escondida",4),rep( "Sinai",4)),
x = c(0.7,1.7,2.7,3.7,0.7,1.7,2.7,3.7), y = c(90, 167,70,205,239,221,257,190),xend = c(1.3,2.3,3.3,4.3,1.3,2.3,3.3,4.3), yend = c(90, 167,70,205,239,221,257,1905), label = rep("*",8))
p1 <- p1 + geom_segment(data = data_hline,aes(x = x,y = y,xend = xend, yend = yend),inherit.aes = FALSE)
p1 <- p1 + geom_text(data = data_hline,aes(label = label,x = x+0.3,y = y+5),inherit.aes = FALSE)
p1
p1 <-  ggplot(mat1, aes(x = factor(Harvest, levels = c("2019_m" , "2020_t" , "2020_m" , "2021_t")), y = Incidence, fill = factor(Time))) + geom_bar(stat="identity", positio=position_dodge())
p1 <- p1 + scale_fill_manual(values=c("gray90", "gray80"))
p1 <- p1 + geom_errorbar(aes(ymin=Incidence-Incidence_se, ymax=Incidence+Incidence_se), width=.2,position=position_dodge(.9))
p1 <- p1 + facet_wrap(~ Farm) + theme_classic()
p1 <- p1 +  xlab("Harvest") + ylab("Necrotic spots") + labs(fill='Days postharvest')
p1 <- p1 + theme(axis.title =element_text(size=14,family = 'serif'))
p1 <- p1 +  theme(axis.text.x = element_text(face="bold",size=12, angle=0,family = 'serif'),
axis.text.y = element_text(face="bold",size=12, angle=0,family = 'serif'))
p1 <- p1 + theme(strip.text.x = element_text(size = 14,family = 'serif'))
p1 <- p1 + scale_color_manual(name = "Harvest", values =  c("gray88","gray70","gray47","gray0"))
p1 <- p1 + theme(legend.text = element_text(size=12, angle=0,family = 'serif'),
legend.title = element_text(face="bold",size=12, angle=0,family = 'serif'))
data_hline <- data.frame(Farm = c(rep("Escondida",4),rep( "Sinai",4)),
x = c(0.7,1.7,2.7,3.7,0.7,1.7,2.7,3.7), y = c(90, 167,70,205,239,221,257,190),xend = c(1.3,2.3,3.3,4.3,1.3,2.3,3.3,4.3), yend = c(90, 167,70,205,239,221,257,190), label = rep("*",8))
p1 <- p1 + geom_segment(data = data_hline,aes(x = x,y = y,xend = xend, yend = yend),inherit.aes = FALSE)
p1 <- p1 + geom_text(data = data_hline,aes(label = label,x = x+0.3,y = y+5),inherit.aes = FALSE)
p1
p1 <-  ggplot(mat1, aes(x = factor(Harvest, levels = c("2019_m" , "2020_t" , "2020_m" , "2021_t")), y = Incidence, fill = factor(Time))) + geom_bar(stat="identity", positio=position_dodge())
p1 <- p1 + scale_fill_manual(values=c("gray90", "gray80"))
p1 <- p1 + geom_errorbar(aes(ymin=Incidence-Incidence_se, ymax=Incidence+Incidence_se), width=.2,position=position_dodge(.9))
p1 <- p1 + facet_wrap(~ Farm) + theme_classic()
p1 <- p1 +  xlab("Harvest") + ylab("Necrotic spots") + labs(fill='Days postharvest')
p1 <- p1 + theme(axis.title =element_text(size=14,family = 'serif'))
p1 <- p1 +  theme(axis.text.x = element_text(face="bold",size=12, angle=0,family = 'serif'),
axis.text.y = element_text(face="bold",size=12, angle=0,family = 'serif'))
p1 <- p1 + theme(strip.text.x = element_text(size = 14,family = 'serif'))
p1 <- p1 + scale_color_manual(name = "Harvest", values =  c("gray88","gray70","gray47","gray0"))
p1 <- p1 + theme(legend.text = element_text(size=12, angle=0,family = 'serif'),
legend.title = element_text(face="bold",size=12, angle=0,family = 'serif'))
data_hline <- data.frame(Farm = c(rep("Escondida",4),rep( "Sinai",4)),
x = c(0.7,1.7,2.7,3.7,0.7,1.7,2.7,3.7), y = c(89, 166,70,204,239,218,257,189),xend = c(1.3,2.3,3.3,4.3,1.3,2.3,3.3,4.3), yend = c(89, 166,70,204,239,218,257,1890), label = rep("*",8))
p1 <- p1 + geom_segment(data = data_hline,aes(x = x,y = y,xend = xend, yend = yend),inherit.aes = FALSE)
p1 <- p1 + geom_text(data = data_hline,aes(label = label,x = x+0.3,y = y+5),inherit.aes = FALSE)
p1
p1 <-  ggplot(mat1, aes(x = factor(Harvest, levels = c("2019_m" , "2020_t" , "2020_m" , "2021_t")), y = Incidence, fill = factor(Time))) + geom_bar(stat="identity", positio=position_dodge())
p1 <- p1 + scale_fill_manual(values=c("gray90", "gray80"))
p1 <- p1 + geom_errorbar(aes(ymin=Incidence-Incidence_se, ymax=Incidence+Incidence_se), width=.2,position=position_dodge(.9))
p1 <- p1 + facet_wrap(~ Farm) + theme_classic()
p1 <- p1 +  xlab("Harvest") + ylab("Necrotic spots") + labs(fill='Days postharvest')
p1 <- p1 + theme(axis.title =element_text(size=14,family = 'serif'))
p1 <- p1 +  theme(axis.text.x = element_text(face="bold",size=12, angle=0,family = 'serif'),
axis.text.y = element_text(face="bold",size=12, angle=0,family = 'serif'))
p1 <- p1 + theme(strip.text.x = element_text(size = 14,family = 'serif'))
p1 <- p1 + scale_color_manual(name = "Harvest", values =  c("gray88","gray70","gray47","gray0"))
p1 <- p1 + theme(legend.text = element_text(size=12, angle=0,family = 'serif'),
legend.title = element_text(face="bold",size=12, angle=0,family = 'serif'))
data_hline <- data.frame(Farm = c(rep("Escondida",4),rep( "Sinai",4)),
x = c(0.7,1.7,2.7,3.7,0.7,1.7,2.7,3.7), y = c(89, 166,70,204,239,218,257,189),xend = c(1.3,2.3,3.3,4.3,1.3,2.3,3.3,4.3), yend = c(89, 166,70,204,239,218,257,189), label = rep("*",8))
p1 <- p1 + geom_segment(data = data_hline,aes(x = x,y = y,xend = xend, yend = yend),inherit.aes = FALSE)
p1 <- p1 + geom_text(data = data_hline,aes(label = label,x = x+0.3,y = y+5),inherit.aes = FALSE)
p1
p1 <-  ggplot(mat1, aes(x = factor(Harvest, levels = c("2019_m" , "2020_t" , "2020_m" , "2021_t")), y = Incidence, fill = factor(Time))) + geom_bar(stat="identity", positio=position_dodge())
p1 <- p1 + scale_fill_manual(values=c("gray90", "gray80"))
p1 <- p1 + geom_errorbar(aes(ymin=Incidence-Incidence_se, ymax=Incidence+Incidence_se), width=.2,position=position_dodge(.9))
p1 <- p1 + facet_wrap(~ Farm) + theme_classic()
p1 <- p1 +  xlab("Harvest") + ylab("Necrotic spots") + labs(fill='Days postharvest')
p1 <- p1 + theme(axis.title =element_text(size=14,family = 'serif'))
p1 <- p1 +  theme(axis.text.x = element_text(face="bold",size=12, angle=0,family = 'serif'),
axis.text.y = element_text(face="bold",size=12, angle=0,family = 'serif'))
p1 <- p1 + theme(strip.text.x = element_text(size = 14,family = 'serif'))
p1 <- p1 + scale_color_manual(name = "Harvest", values =  c("gray88","gray70","gray47","gray0"))
p1 <- p1 + theme(legend.text = element_text(size=12, angle=0,family = 'serif'),
legend.title = element_text(face="bold",size=12, angle=0,family = 'serif'))
data_hline <- data.frame(Farm = c(rep("Escondida",4),rep( "Sinai",4)),
x = c(0.7,1.7,2.7,3.7,0.7,1.7,2.7,3.7), y = c(88, 165,70,203,238,217,256,187),xend = c(1.3,2.3,3.3,4.3,1.3,2.3,3.3,4.3), yend = c(88, 165,70,203,238,217,256,187), label = rep("*",8))
p1 <- p1 + geom_segment(data = data_hline,aes(x = x,y = y,xend = xend, yend = yend),inherit.aes = FALSE)
p1 <- p1 + geom_text(data = data_hline,aes(label = label,x = x+0.3,y = y+5),inherit.aes = FALSE)
p1
plot<-grid.arrange(p + labs(tag = 'A'),p1 + labs(tag = 'B'), ncol=1,nrow=2)
ggsave("C:/Users/Dru/Desktop/Cartama_paper/Figure2.jpg",plot=plot,dpi = 300,width = 7,height = 7,units = c("in"))
data_hline <- data.frame(Farm = c(rep("Escondida",4),rep( "Sinai",4)),
x = c(0.7,1.7,2.7,3.7,0.7,1.7,2.7,3.7), y = c(1.2, 2.4,0.9,4.7,2.8,4.6,5.4,3.6),xend = c(1.3,2.3,3.3,4.3,1.3,2.3,3.3,4.3), yend = c(1.2, 2.4,0.9,4.7,2.8,4.6,5.4,3.6), label = rep("*",8))
p <-  ggplot(mat1, aes(x = factor(Harvest, levels = c("2019_m" , "2020_t" , "2020_m" , "2021_t")), y = Severity, fill = factor(Time))) + geom_bar(stat="identity", positio=position_dodge())
p <- p + scale_fill_manual(values=c("gray90", "gray80"))
p <- p + geom_errorbar(aes(ymin=Severity-Severity_se, ymax=Severity+Severity_se), width=.2,position=position_dodge(.9))
p <- p + facet_grid(~ Farm) + theme_classic()
p <- p +  xlab("") + ylab("Necrotic Area (%)") + labs(fill='Days postharvest')
p <- p + theme(axis.title =element_text(size=14,family = 'serif'))
p <- p +  theme(axis.text.x = element_text(face="bold",size=12, angle=0,family = 'serif'),
axis.text.y = element_text(face="bold",size=12, angle=0,family = 'serif'))
p <- p + theme(strip.text.x = element_text(size = 14,family = 'serif'))
p <- p + theme(legend.text = element_text(size=12, angle=0,family = 'serif'),
legend.title = element_text(face="bold",size=12, angle=0,family = 'serif'))
p <- p + geom_segment(data = data_hline,aes(x = x,y = y,xend = xend, yend = yend),inherit.aes = FALSE)
p <- p +geom_text(data = data_hline,aes(label = label,x = x+0.3,y = y+0.2),inherit.aes = FALSE)
plot<-grid.arrange(p + labs(tag = 'A'),p1 + labs(tag = 'B'), ncol=1,nrow=2)
ggsave("C:/Users/Dru/Desktop/Cartama_paper/Figure2.jpg",plot=plot,dpi = 300,width = 7,height = 7,units = c("in"))
library(glmmTMB)
library(bbmle)
library(DHARMa)
library(readxl)
library(tidyverse)
Lenticel_file <- read_excel("C:/Users/Dru/Desktop/Cartama_paper/files/Lenticel_Damage_Summary_All_Harvest.xlsx")
glimpse(Lenticel_file)
table(Lenticel_file$Cosecha)
table(Lenticel_file$UP)
f <-subset(Lenticel_file,Lenticel_file$UP=="Escondida")
f1 <- subset(Lenticel_file,Lenticel_file$UP=="Sinai")
table(f$Lote)
table(f$Arbol)
table(f1$Lote)
table(f1$Arbol)
summary(Lenticel_file$Severidad_0)
summary(Lenticel_file$Severidad_1)
summary(Lenticel_file$Incidencia_0)
summary(Lenticel_file$Incidencia_1)
Lenticel_file$...13<-NULL
Lenticel_file$...14<-NULL
Lenticel_file$...15<-NULL
Lenticel_file$Año<-NULL
Lenticel_file$cosecha<-NULL
Lenticel_file$Severidad_pedunculo<-NULL
Lenticel_file[Lenticel_file=="2019_p"]<-"2019_m"
Lenticel_file[Lenticel_file=="2020_p"]<-"2020_m"
Lenticel_file$Tree<-paste(Lenticel_file$UP,Lenticel_file$Arbol,sep="")
Lenticel_file$Arbol<-NULL
df <- Lenticel_file %>% drop_na(Severidad_0 , Incidencia_0)
colnames(df)[which(names(df) == "Cosecha")] <- "Harvest"
colnames(df)[which(names(df) == "UP")] <- "Farm"
colnames(df)[which(names(df) == "Lote")] <- "Plot"
colnames(df)[which(names(df) == "Fruta")] <- "Fruit"
colnames(df)[which(names(df) == "Severidad_0")] <- "Sev_0dph"
colnames(df)[which(names(df) == "Severidad_1")] <- "Sev_21dph"
colnames(df)[which(names(df) == "Incidencia_0")] <- "Inc_0dph"
colnames(df)[which(names(df) == "Incidencia_1")] <- "Inc_21dph"
df$Inc_ratio <- df$Inc_21dph-df$Inc_0dph
df$Sev_ratio <- df$Sev_21dph-df$Sev_0dph
glimpse(df)
summary(df$Sev_0dph)
#Datos_mat<-subset(Datos_mat,Datos_mat$Cosecha!="2020_t")
plot<-factor(df$Plot)
tree<-factor(df$Tree)
farm<-factor(df$Farm)
fpt<-farm:plot:tree
fp<-farm:plot
pt<- plot:tree
year<-factor(df$Harvest)
fruta<-factor(df$Fruit)
y<-df$Sev_0dph/100
modelo <- glmmTMB(y~farm*year + (1|farm) + (1|fp) + (1|fpt),ziformula=~year,family=beta_family())
modelo1 <- glmmTMB(y~farm+year + (1|farm) + (1|fp) + (1|fpt),ziformula=~year,family=beta_family())
#modelo2 <- glmmTMB(y~year + (1|farm) + (1|fp) + (1|fpt),ziformula=~year,family=beta_family())
#modelo3 <- glmmTMB(y~farm + (1|farm) + (1|fp) + (1|fpt),ziformula=~year,family=beta_family())
#AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE)
residual_simulation<-simulateResiduals(modelo1)
plot(residual_simulation)
residual_simulation_years <-recalculateResiduals(residual_simulation, group = df$Tree)
plot(residual_simulation_years)
testDispersion(residual_simulation)
testZeroInflation(residual_simulation)
testCategorical(residual_simulation, catPred = df$Tree)
par(mfrow = c(1,2))
plotResiduals(residual_simulation, farm)
plotResiduals(residual_simulation, year)
#sink("Sev_0h.txt")
#print(summary(modelo1))
#sink()
anova(modelo, modelo1)
#AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE)
residual_simulation<-simulateResiduals(modelo)
plot(residual_simulation)
residual_simulation_years <-recalculateResiduals(residual_simulation, group = df$Tree)
plot(residual_simulation_years)
testDispersion(residual_simulation)
testZeroInflation(residual_simulation)
testCategorical(residual_simulation, catPred = df$Tree)
par(mfrow = c(1,2))
plotResiduals(residual_simulation, farm)
plotResiduals(residual_simulation, year)
#sink("Sev_0h.txt")
#print(summary(modelo1))
#sink()
#AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE)
residual_simulation<-simulateResiduals(modelo1)
plot(residual_simulation)
residual_simulation_years <-recalculateResiduals(residual_simulation, group = df$Tree)
plot(residual_simulation_years)
testDispersion(residual_simulation)
testZeroInflation(residual_simulation)
testCategorical(residual_simulation, catPred = df$Tree)
par(mfrow = c(1,2))
plotResiduals(residual_simulation, farm)
plotResiduals(residual_simulation, year)
#sink("Sev_0h.txt")
#print(summary(modelo1))
#sink()
y<-round(df$Inc_0dph)
modelo <- glmmTMB(y~farm*year + (1|farm) + (1|fp) + (1|fpt),ziformula=~year,family=nbinom2)
modelo1 <- glmmTMB(y~farm+year + (1|farm) + (1|fp) + (1|fpt),ziformula=~year,family=nbinom2)
#modelo2 <- glmmTMB(y~year + (1|farm) + (1|fp) + (1|fpt),ziformula=~year,family=nbinom2)
#modelo3 <- glmmTMB(y~farm + (1|farm) + (1|fp) + (1|fpt),ziformula=~year,family=nbinom2)
#AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE)
residual_simulation<-simulateResiduals(modelo1)
plot(residual_simulation)
residual_simulation_years <-recalculateResiduals(residual_simulation, group = df$Tree)
plot(residual_simulation_years)
testDispersion(residual_simulation)
testZeroInflation(residual_simulation)
#testCategorical(residual_simulation, catPred = df$Tree)
par(mfrow = c(1,2))
plotResiduals(residual_simulation, farm)
plotResiduals(residual_simulation, year)
#sink("In_0h.txt")
#print(summary(modelo1))
#sink()
anova(modelo,modelo1)
#AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE)
residual_simulation<-simulateResiduals(modelo)
plot(residual_simulation)
residual_simulation_years <-recalculateResiduals(residual_simulation, group = df$Tree)
plot(residual_simulation_years)
testDispersion(residual_simulation)
testZeroInflation(residual_simulation)
#testCategorical(residual_simulation, catPred = df$Tree)
par(mfrow = c(1,2))
plotResiduals(residual_simulation, farm)
plotResiduals(residual_simulation, year)
#sink("In_0h.txt")
#print(summary(modelo1))
#sink()
y<-round(df$Inc_0dph)
modelo <- glmmTMB(y~farm*year + (1|farm) + (1|fp) + (1|fpt),ziformula=~1,family=nbinom2)
modelo1 <- glmmTMB(y~farm+year + (1|farm) + (1|fp) + (1|fpt),ziformula=~1,family=nbinom2)
#modelo2 <- glmmTMB(y~year + (1|farm) + (1|fp) + (1|fpt),ziformula=~year,family=nbinom2)
#modelo3 <- glmmTMB(y~farm + (1|farm) + (1|fp) + (1|fpt),ziformula=~year,family=nbinom2)
#AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE)
residual_simulation<-simulateResiduals(modelo)
plot(residual_simulation)
residual_simulation_years <-recalculateResiduals(residual_simulation, group = df$Tree)
plot(residual_simulation_years)
testDispersion(residual_simulation)
testZeroInflation(residual_simulation)
#testCategorical(residual_simulation, catPred = df$Tree)
par(mfrow = c(1,2))
plotResiduals(residual_simulation, farm)
plotResiduals(residual_simulation, year)
#sink("In_0h.txt")
#print(summary(modelo1))
#sink()
#AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE)
residual_simulation<-simulateResiduals(modelo1)
plot(residual_simulation)
residual_simulation_years <-recalculateResiduals(residual_simulation, group = df$Tree)
plot(residual_simulation_years)
testDispersion(residual_simulation)
testZeroInflation(residual_simulation)
#testCategorical(residual_simulation, catPred = df$Tree)
par(mfrow = c(1,2))
plotResiduals(residual_simulation, farm)
plotResiduals(residual_simulation, year)
#sink("In_0h.txt")
#print(summary(modelo1))
#sink()
summary(modelo1)
summary(modelo)
AICtab(modelo,modelo1)
sink("In_0h.txt")
print(summary(modelo1))
sink()
setwd("C:/Users/Dru/Desktop/Cartama_paper/nuevos_resultados")
sink("In_0h.txt")
print(summary(modelo1))
sink()
y<-df$Sev_0dph/100
modelo <- glmmTMB(y~farm+year + (1|farm) + (1|fp) + (1|fpt),ziformula=~year,family=beta_family())
modelo1 <- glmmTMB(y~farm+year + (1|farm) + (1|fp) + (1|fpt),ziformula=~1,family=beta_family())
#modelo2 <- glmmTMB(y~year + (1|farm) + (1|fp) + (1|fpt),ziformula=~year,family=beta_family())
#modelo3 <- glmmTMB(y~farm + (1|farm) + (1|fp) + (1|fpt),ziformula=~year,family=beta_family())
AICtab(modelo,modelo1)
anova(modelo,modelo1)
sink("Sev_0h.txt")
print(summary(modelo1))
sink()
cite(glmmTMB)
citation(glmmTMB)
citation("glmmTMB")
citation("DARMa")
citation("DHARMa")
version ("glmmTMB")
version("glmmTMB")
AICtab(modelo,modelo1)
y<-df$Sev_0dph/100
modelo <- glmmTMB(y~farm*year + (1|farm) + (1|fp) + (1|fpt),ziformula=~1,family=beta_family())
modelo1 <- glmmTMB(y~farm+year + (1|farm) + (1|fp) + (1|fpt),ziformula=~1,family=beta_family())
modelo2 <- glmmTMB(y~year + (1|farm) + (1|fp) + (1|fpt),ziformula=~1,family=beta_family())
modelo3 <- glmmTMB(y~farm + (1|farm) + (1|fp) + (1|fpt),ziformula=~1,family=beta_family())
AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE)
names(AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE))
names(AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE, plot = TRUE))
names(AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE, plot = TRUE)
names(AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE, plot = TRUE))
names(AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE))
AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE, plot = TRUE)
AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE, weights = TRUE)
sink("Sev_0h.txt")
print(summary(modelo))
sink()
citacion(bbmle)
citacion("bbmle")
citation("bbmle")
y<-round(df$Inc_0dph)
modelo <- glmmTMB(y~farm*year + (1|farm) + (1|fp) + (1|fpt),ziformula=~1,family=nbinom2)
modelo1 <- glmmTMB(y~farm+year + (1|farm) + (1|fp) + (1|fpt),ziformula=~1,family=nbinom2)
modelo2 <- glmmTMB(y~year + (1|farm) + (1|fp) + (1|fpt),ziformula=~1,family=nbinom2)
modelo3 <- glmmTMB(y~farm + (1|farm) + (1|fp) + (1|fpt),ziformula=~1,family=nbinom2)
AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE)
residual_simulation<-simulateResiduals(modelo)
plot(residual_simulation)
residual_simulation_years <-recalculateResiduals(residual_simulation, group = df$Tree)
plot(residual_simulation_years)
testDispersion(residual_simulation)
testZeroInflation(residual_simulation)
#testCategorical(residual_simulation, catPred = df$Tree)
par(mfrow = c(1,2))
plotResiduals(residual_simulation, farm)
plotResiduals(residual_simulation, year)
sink("In_0h.txt")
print(summary(modelo))
sink()
AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE,weights = TRUE)
AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE,weights = TRUE)
residual_simulation<-simulateResiduals(modelo)
plot(residual_simulation)
residual_simulation_years <-recalculateResiduals(residual_simulation, group = df$Tree)
plot(residual_simulation_years)
testDispersion(residual_simulation)
testZeroInflation(residual_simulation)
testCategorical(residual_simulation, catPred = df$Tree)
par(mfrow = c(1,2))
plotResiduals(residual_simulation, farm)
plotResiduals(residual_simulation, year)
sink("Sev_0h.txt")
print(summary(modelo))
sink()
sink("Sev_0h.txt")
print(summary(modelo))
sink()
y<-df$Sev_0dph/100
modelo <- glmmTMB(y~farm*year + (1|farm) + (1|fp) + (1|fpt),ziformula=~1,family=beta_family())
modelo1 <- glmmTMB(y~farm+year + (1|farm) + (1|fp) + (1|fpt),ziformula=~1,family=beta_family())
modelo2 <- glmmTMB(y~year + (1|farm) + (1|fp) + (1|fpt),ziformula=~1,family=beta_family())
modelo3 <- glmmTMB(y~farm + (1|farm) + (1|fp) + (1|fpt),ziformula=~1,family=beta_family())
sink("Sev_0h.txt")
print(summary(modelo))
sink()
dfe<-na.omit(subset(df,df$Farm=="Escondida"))
dfs<-na.omit(subset(df,df$Farm=="Sinai"))
df1<-na.omit(df)
y<-c(df1$Sev_0dph,df1$Sev_21dph)/100
ye<-c(dfe$Sev_0dph,dfe$Sev_21dph)/100
ys<-c(dfs$Sev_0dph,dfs$Sev_21dph)/100
time<-factor(c(rep("0dpc",length(y)/2),rep("21dpc",length(y)/2)))
timee<-factor(c(rep("0dpc",length(ye)/2),rep("21dpc",length(ye)/2)))
times<-factor(c(rep("0dpc",length(ys)/2),rep("21dpc",length(ys)/2)))
farm<-c(df1$Farm,df1$Farm)
f<-factor(c(df1$Fruit,df1$Fruit))
h<-factor(c(df1$Harvest,df1$Harvest))
fe<-factor(c(dfe$Fruit,dfe$Fruit))
he<-factor(c(dfe$Harvest,dfe$Harvest))
fs<-factor(c(dfs$Fruit,dfs$Fruit))
hs<-factor(c(dfs$Harvest,dfs$Harvest))
#modelo <- glmmTMB(y ~ time * h *farm + (1|f)  ,ziformula= ~ 1,family=beta_family())
#modelos <- glmmTMB(ys ~ times * hs + (1|fs) ,ziformula= ~ 1,family=beta_family())
#modeloe <- glmmTMB(ye ~ timee * he + (1|fe) ,ziformula= ~ he + timee,family=beta_family())
dfe<-na.omit(subset(df,df$Farm=="Escondida"))
dfs<-na.omit(subset(df,df$Farm=="Sinai"))
df1<-na.omit(df)
y<-c(df1$Sev_0dph,df1$Sev_21dph)/100
ye<-c(dfe$Sev_0dph,dfe$Sev_21dph)/100
ys<-c(dfs$Sev_0dph,dfs$Sev_21dph)/100
time<-factor(c(rep("0dpc",length(y)/2),rep("21dpc",length(y)/2)))
timee<-factor(c(rep("0dpc",length(ye)/2),rep("21dpc",length(ye)/2)))
times<-factor(c(rep("0dpc",length(ys)/2),rep("21dpc",length(ys)/2)))
farm<-c(df1$Farm,df1$Farm)
f<-factor(c(df1$Fruit,df1$Fruit))
h<-factor(c(df1$Harvest,df1$Harvest))
fe<-factor(c(dfe$Fruit,dfe$Fruit))
he<-factor(c(dfe$Harvest,dfe$Harvest))
fs<-factor(c(dfs$Fruit,dfs$Fruit))
hs<-factor(c(dfs$Harvest,dfs$Harvest))
modelo <- glmmTMB(y ~ time * h *farm + (1|f)  ,ziformula= ~ 1,family=beta_family())
modelos <- glmmTMB(ys ~ times * hs + (1|fs) ,ziformula= ~ 1,family=beta_family())
modeloe <- glmmTMB(ye ~ timee * he + (1|fe) ,ziformula= ~ he + timee,family=beta_family())
modelo <- glmmTMB(y ~ time * h *farm + (1|f)  ,ziformula= ~ 1,family=beta_family())
modelo1 <-glmmTMB(y ~ time * h +farm + (1|f)  ,ziformula= ~ 1,family=beta_family())
modelo2 <- glmmTMB(y ~ time + h *farm + (1|f)  ,ziformula= ~ 1,family=beta_family())
modelo3 <- glmmTMB(y ~ time + h +farm + (1|f)  ,ziformula= ~ 1,family=beta_family())
AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE)
residual_simulation<-simulateResiduals(modelo)
plot(residual_simulation)
testDispersion(residual_simulation)
testZeroInflation(residual_simulation)
par(mfrow = c(1,2))
plotResiduals(residual_simulation, h)
AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE,weights = TRUE)
#modelo <- glmmTMB(y ~ time * h *farm + (1|f)  ,ziformula= ~ 1,family=beta_family())
#modelo1 <-glmmTMB(y ~ time * h +farm + (1|f)  ,ziformula= ~ 1,family=beta_family())
#modelo2 <- glmmTMB(y ~ time + h *farm + (1|f)  ,ziformula= ~ 1,family=beta_family())
#modelo3 <- glmmTMB(y ~ time + h +farm + (1|f)  ,ziformula= ~ 1,family=beta_family())
AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE,weights = TRUE)
residual_simulation<-simulateResiduals(modelo)
plot(residual_simulation)
testDispersion(residual_simulation)
testZeroInflation(residual_simulation)
par(mfrow = c(1,2))
plotResiduals(residual_simulation, h)
summary(modelo)
sink("Se_0h_21h.txt")
print(summary(modelo))
sink()
dfe<-na.omit(subset(df,df$Farm=="Escondida"))
dfs<-na.omit(subset(df,df$Farm=="Sinai"))
df1<-na.omit(df)
y<-round(c(df1$Sev_0dph,df1$Sev_21dph))
ye<-round(c(dfe$Inc_0dph,dfe$Inc_21dph))
ys<-round(c(dfs$Inc_0dph,dfs$Inc_21dph))
time<-factor(c(rep("0dpc",length(y)/2),rep("21dpc",length(y)/2)))
timee<-factor(c(rep("0dpc",length(ye)/2),rep("21dpc",length(ye)/2)))
times<-factor(c(rep("0dpc",length(ys)/2),rep("21dpc",length(ys)/2)))
farm<-c(df1$Farm,df1$Farm)
f<-factor(c(df1$Fruit,df1$Fruit))
h<-factor(c(df1$Harvest,df1$Harvest))
fe<-factor(c(dfe$Fruit,dfe$Fruit))
he<-factor(c(dfe$Harvest,dfe$Harvest))
fs<-factor(c(dfs$Fruit,dfs$Fruit))
hs<-factor(c(dfs$Harvest,dfs$Harvest))
#modelo <- glmmTMB(y ~ time * h *farm + (1|f)  ,ziformula= ~ 1,family=beta_family())
modelo <- glmmTMB(y ~ time * h *farm + (1|f)  ,ziformula= ~ 1,family=nbinom2)
modelo1 <-glmmTMB(y ~ time * h +farm + (1|f)  ,ziformula= ~ 1,family=nbinom2)
modelo2 <- glmmTMB(y ~ time + h *farm + (1|f)  ,ziformula= ~ 1,family=nbinom2)
modelo3 <- glmmTMB(y ~ time + h +farm + (1|f)  ,ziformula= ~ 1,family=nbinom2)
#modeloe <- glmmTMB(ye ~ timee * he + (1|fe) ,ziformula= ~ 1 + timee,family=nbinom2)
AICtab(modelo,modelo1,modelo2,modelo3, base=TRUE)
#modelos <- glmmTMB(ys ~ times * hs + (1|fs) ,ziformula= ~ 1,family=nbinom2)
residual_simulation<-simulateResiduals(modelo)
plot(residual_simulation)
testDispersion(residual_simulation)
testZeroInflation(residual_simulation)
plotResiduals(residual_simulation, h)
sink("In_0h_21h.txt")
print(summary(modelo))
sink()
sink("In_0h_21h.txt")
print(summary(modelo))
sink()
